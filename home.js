// var Array=[{
//     id:1,Chemicalname:"Ammonium Persulfate",Vender:"LG Chem",Density:"3525.92",Viscosity:"60.63",Packaging:"Bag",Packsize:"100.00",Unit:"kg",Quantity:"6495.18"},
// {id:2,Chemicalname:"Caustic Potash",Vender:"Formosa",Density:"3172.15",Viscosity:"48.22",Packaging:"Bag",Packsize:"180.00",Unit:"kg",Quantity:"8751.90"},
// {id:3,Chemicalname:"Dimethylaminopropylamino",Vender:"LG Chem",Density:"8435.37",Viscosity:"12.62",Packaging:"Barrel",Packsize:"75.00",Unit:"L",Quantity:"5964.61"},
// {id:4,Chemicalname:"Mono Ammonium Phosphate",Vender:"Sinopec",Density:"1597.65",Viscosity:"76.51",Packaging:"Bag",Packsize:"105.00",Unit:"kg",Quantity:"8183.73"},
// {id:5,Chemicalname:"Ferric Nitrate",Vender:"DowDuPont",Density:"364.04",Viscosity:"14.90",Packaging:"Bag",Packsize:"105.00",Unit:"kg",Quantity:"4154.33"},
// {id:6,Chemicalname:"n-Pentane",Vender:"Sinopec",Density:"4535.26",Viscosity:"66.76",Packaging:"N/A",Packsize:"N/A",Unit:"t",Quantity:"6272.34"},
// {id:7,Chemicalname:"Glycol Ether PM",Vender:"LG Chem",Density:"6495.18",Viscosity:"72.12",Packaging:"Bag",Packsize:"250.00",Unit:"kg",Quantity:"8749.54"}];
var chemicals =[
    {
        "id": 1,
        "Chemicalname": "Ammonium Persulfate",
        "Vender": "LG Chem",
        "Density": "3525.92",
        "Viscosity": "60.63",
        "Packaging": "Bag",
        "Packsize": "100.00",
        "Unit": "kg",
        "Quantity": "6495.18"
    },
    {
        "id": 2,
        "Chemicalname": "Caustic Potash",
        "Vender": "Formosa",
        "Density": "3172.15",
        "Viscosity": "48.22",
        "Packaging": "Bag",
        "Packsize": "180.00",
        "Unit": "kg",
        "Quantity": "8751.90"
    },
    {
        "id": 3,
        "Chemicalname": "Dimethylaminopropylamino",
        "Vender": "LG Chem",
        "Density": "8435.37",
        "Viscosity": "12.62",
        "Packaging": "Barrel",
        "Packsize": "75.00",
        "Unit": "L",
        "Quantity": "5964.61"
    },
    {
        "id": 4,
        "Chemicalname": "Mono Ammonium Phosphate",
        "Vender": "Sinopec",
        "Density": "1597.65",
        "Viscosity": "76.51",
        "Packaging": "Bag",
        "Packsize": "105.00",
        "Unit": "kg",
        "Quantity": "8183.73"
    },
    {
        "id": 5,
        "Chemicalname": "Ferric Nitrate",
        "Vender": "DowDuPont",
        "Density": "364.04",
        "Viscosity": "14.90",
        "Packaging": "Bag",
        "Packsize": "105.00",
        "Unit": "kg",
        "Quantity": "4154.33"
    },
    {
        "id": 6,
        "Chemicalname": "n-Pentane",
        "Vender": "Sinopec",
        "Density": "4535.26",
        "Viscosity": "66.76",
        "Packaging": "N/A",
        "Packsize": "N/A",
        "Unit": "t",
        "Quantity": "6272.34"
    },
    {
        "id": 7,
        "Chemicalname": "Glycol Ether PM",
        "Vender": "LG Chem",
        "Density": "6495.18",
        "Viscosity": "72.12",
        "Packaging": "Bag",
        "Packsize": "250.00",
        "Unit": "kg",
        "Quantity": "8749.54"
    }, {
        "id": 8,
        "Chemicalname": "Ammonium Persulfate",
        "Vender": "LG Chem",
        "Density": "3525.92",
        "Viscosity": "60.63",
        "Packaging": "Bag",
        "Packsize": "100.00",
        "Unit": "kg",
        "Quantity": "6495.18"
    },
    {
        "id": 9,
        "Chemicalname": "Caustic Potash",
        "Vender": "Formosa",
        "Density": "3172.15",
        "Viscosity": "48.22",
        "Packaging": "Bag",
        "Packsize": "180.00",
        "Unit": "kg",
        "Quantity": "8751.90"
    },
    {
        "id": 10,
        "Chemicalname": "Dimethylaminopropylamino",
        "Vender": "LG Chem",
        "Density": "8435.37",
        "Viscosity": "12.62",
        "Packaging": "Barrel",
        "Packsize": "75.00",
        "Unit": "L",
        "Quantity": "5964.61"
    },
    {
        "id": 11,
        "Chemicalname": "Mono Ammonium Phosphate",
        "Vender": "Sinopec",
        "Density": "1597.65",
        "Viscosity": "76.51",
        "Packaging": "Bag",
        "Packsize": "105.00",
        "Unit": "kg",
        "Quantity": "8183.73"
    },
    {
        "id": 12,
        "Chemicalname": "Ferric Nitrate",
        "Vender": "DowDuPont",
        "Density": "364.04",
        "Viscosity": "14.90",
        "Packaging": "Bag",
        "Packsize": "105.00",
        "Unit": "kg",
        "Quantity": "4154.33"
    },
    {
        "id": 13,
        "Chemicalname": "n-Pentane",
        "Vender": "Sinopec",
        "Density": "4535.26",
        "Viscosity": "66.76",
        "Packaging": "N/A",
        "Packsize": "N/A",
        "Unit": "t",
        "Quantity": "6272.34"
    },
    {
        "id": 14,
        "Chemicalname": "Glycol Ether PM",
        "Vender": "LG Chem",
        "Density": "6495.18",
        "Viscosity": "72.12",
        "Packaging": "Bag",
        "Packsize": "250.00",
        "Unit": "kg",
        "Quantity": "8749.54"
    },  {
        "id": 15,
        "Chemicalname": "Ferric Nitrate",
        "Vender": "DowDuPont",
        "Density": "364.04",
        "Viscosity": "14.90",
        "Packaging": "Bag",
        "Packsize": "105.00",
        "Unit": "kg",
        "Quantity": "4154.33"
    }
]
var i=0;
var arrSelectId=[];
var arrCur=chemicals;
//arrCur.push(chemicals);
// function tableData(chemicals){
// // var tr=document.createElement("tr");
// var a=document.getElementById("chemicalBody");
// for (const key in chemicals) {
//    var b =`<tr id="tr${chemicals[key].id}"><td> <i id="${chemicals[key].id}" onclick="selectForDelete(event)"  style="color:#ddd;cursor:pointer;" class="fa-solid fa-check"></i></td><td>${chemicals[key].id} </td><td colspan=1 >${chemicals[key].Chemicalname} </td><td>${chemicals[key].Vender} </td><td>${chemicals[key].Density} </td><td>${chemicals[key].Viscosity}</td><td>${chemicals[key].Packaging}</td><td>${chemicals[key].Packsize} </td><td>${chemicals[key].Unit} </td><td>${chemicals[key].Quantity}</td></tr>`;
//    a.innerHTML+=b;
//     // console.log(key["Viscosity"]);
//   console.log(chemicals[key]);
//     // document.getElementById("add").append(a);
// }
// }
// tableData(chemicals);

function addRow() {
    const table = document.getElementById('chemicalTable');
    let newRow = table.insertRow();
    let cell = newRow.insertCell();
    cell.innerHTML = '<i id="${chemicals[key].id}" onclick="selectForDelete(event)"  style="color:#ddd;cursor:pointer;" class="fa-solid fa-check"></i>';
    for (let i = 0; i < 9; i++) {
         cell = newRow.insertCell();
       if(i==0)
        cell.innerHTML = `<input type="text" id="in${i}" placeholder="" value=${arrCur.length+1}>`;
            //console.log("in"+i);
            else
        cell.innerHTML = `<input type="text" id="in${i}" placeholder="">`;
        
    }
}
var a=0;
function deleteRow() {
    if(i==0)
        alert("please select the delete thing")
    var b="tr".concat(i);
    const table = document.getElementById("chemicalBody");
    const table1 = document.getElementById(b);
   
    //     if(i!=0)
    //  table1.deleteRow(i-1); 
    
        table1.remove(); 
//arrCur.remove(i-1);
     
     arrSelectId= arrSelectId.slice(0,1);
  //  }
  console.log(arrSelectId.toString());
i=0;
}
let editIndex = null; // Track which row is being edited
function openPopup() {
    editIndex = i-1;
    //var i=arrSelectId[0];
    const chemical = chemicals[i-1];
console.log(i);
    // Fill the popup form with the current values
    document.getElementById('editId').value = chemical.id;
    document.getElementById('editName').value = chemical.Chemicalname;
    document.getElementById('editVendor').value = chemical.Vender;
    document.getElementById('editDensity').value = chemical.Density;
    document.getElementById('editViscosity').value = chemical.Viscosity;
    document.getElementById('editPackaging').value = chemical.Packaging;
    document.getElementById('editPackSize').value = chemical.Packsize;
    document.getElementById('editUnit').value = chemical.Unit;
    document.getElementById('editQuantity').value = chemical.Quantity;

    document.getElementById('editPopup').style.display = 'flex';
}
function addNewRow(){
    const newChemical = {
        id: document.getElementById('in0').value,
        Chemicalname: document.getElementById('in1').value,
        Vender: document.getElementById('in2').value,
        Density: document.getElementById('in3').value,
        Viscosity: document.getElementById('in4').value,
        Packaging: document.getElementById('in5').value,
        Packsize: document.getElementById('in6').value,
        Unit: document.getElementById('in7').value,
        Quantity: document.getElementById('in8').value,
    };
    
    saveNewRow(newChemical);
}
function saveEdit() {
    const updatedChemical = {
        id: document.getElementById('editId').value,
        Chemicalname: document.getElementById('editName').value,
        Vender: document.getElementById('editVendor').value,
        Density: document.getElementById('editDensity').value,
        Viscosity: document.getElementById('editViscosity').value,
        Packaging: document.getElementById('editPackaging').value,
        Packsize: document.getElementById('editPackSize').value,
        Unit: document.getElementById('editUnit').value,
        Quantity: document.getElementById('editQuantity').value,
    };
console.log(updatedChemical);
    // Update the array with the edited values
    chemicals[i-1] = updatedChemical;
    console.log(chemicals[i-1]);
    // Re-render the table with updated data
    renderTable(chemicals);

    // Close the popup
    closePopup();
    i=0;
    arrCur[i-1]=updatedChemical
    
}
console.log(i-1);
// Function to close the popup
function closePopup() {
    document.getElementById('editPopup').style.display = 'none';
    i=0;
}
function saveNewRow(newChemical1) {
    chemicals.push(newChemical1);
   // console.log(newChemical1);
    renderTable(chemicals);
   // arrCur.push(newChemical1);
}
function refresh() {
   // console.log(arrCur);
    renderTable(arrCur);
}
function moveRowUp() {
    const table = document.getElementById('chemicalTable');
    // console.log(i);
    // console.log(table.rows[1]);

    if (i > 1) {
        const row = table.rows[i];
        table.tBodies[0].insertBefore(row, table.rows[i - 1]);
    }
}
window.onload = function() {
    renderTable(chemicals);     
};
function moveRowDown() {
    const table = document.getElementById('chemicalTable');
    console.log(i);
    if (i < table.rows.length - 1) {
        const row = table.rows[i];
        // console.log(table.rows[1]);
        table.tBodies[0].insertBefore(row,table.rows[i + 1]);
      
    }
}
let sortDirection = false;

function sortTable(columnIndex) {
    const table = document.getElementById('chemicalTable');
    const tbody = table.tBodies[0];
    const rows = Array.from(tbody.querySelectorAll('tr'));

    const sortedRows = rows.sort((a, b) => {
        const aText = a.cells[columnIndex].textContent.trim();
        const bText = b.cells[columnIndex].textContent.trim();

        if (!isNaN(aText) && !isNaN(bText)) {
            return sortDirection ? bText - aText : aText - bText;
        }
        return sortDirection ? bText.localeCompare(aText) : aText.localeCompare(bText);
    });

    sortDirection = !sortDirection;

    tbody.innerHTML = '';
    tbody.append(...sortedRows);
}
function makeEditable(rowIndex, cellIndex) {
    const table = document.getElementById('chemicalTable');
    const cell = table.rows[rowIndex].cells[cellIndex];
    const originalText = cell.textContent;

    cell.innerHTML = `<input type="text" value="${originalText}" onblur="saveEdit(this, ${rowIndex}, ${cellIndex})">`;
}

function saveNew(input, rowIndex, cellIndex) {
    const table = document.getElementById('chemicalTable');
    const cell = table.rows[rowIndex].cells[cellIndex];
    console.log(cell.Chemicalname);
    cell.textContent = input.value; // save new value
}

function selectForDelete(event){
    // var navbarmenuside = document.getElementById(".navbar-menu-side");
    var id=event.target["id"];
    console.log(id);
    var navbar = document.getElementById(id);
    console.log(navbar.style.color);
  if(navbar.style.color=="rgb(221, 221, 221)"){
     document.getElementById("icon1").style.display="inline";
      navbar.style.color = "black";
      arrSelectId.push(id);
      i=id;
  }
   else{
        navbar.style.color= "rgb(221, 221, 221)";
    arrSelectId.splice(arrSelectId.indexOf(id), 1);
    document.getElementById("icon1").style.display="none";
    i=0;
   }
   console.log(arrSelectId.toString());
}
let currentPage = 1; // Track the current page
const rowsPerPage = 5; // Limit to 5 rows per page

// Function to render the table with pagination
function renderTable(data) {
    console.log(data);
    const tableBody = document.getElementById('chemicalBody');
    tableBody.innerHTML = ''; // Clear existing rows

    // Determine start and end index for current page
    const startIndex = (currentPage - 1) * rowsPerPage;
    const endIndex = startIndex + rowsPerPage;

    // Slice the data to show only the rows for the current page
    const pageData = data.slice(startIndex, endIndex);
var b="tr";
    pageData.forEach((chemical, index) => {
        const tableBody = document.getElementById('chemicalBody');
        const row = document.createElement('tr');
        b.concat(chemical.id);
        row.id="tr".concat(chemical.id);
        row.innerHTML = `<tr id="${b}">
        <td> <i id="${chemical.id}" onclick="selectForDelete(event)"  style="color:#ddd;cursor:pointer;" class="fa-solid fa-check"></i></td>
                        <td>${chemical.id}</td>
            <td>${chemical.Chemicalname}</td>
            <td>${chemical.Vender}</td>
            <td>${chemical.Density}</td>
            <td>${chemical.Viscosity}</td>
            <td>${chemical.Packaging}</td>
            <td>${chemical.Packsize}</td>
            <td>${chemical.Unit}</td>
            <td>${chemical.Quantity}</td>
            </tr>`;
        tableBody.appendChild(row);
    });

    // Render pagination buttons
    renderPagination(chemicals.length);
}

// Function to render pagination controls
function renderPagination(totalRows) {
    const paginationContainer = document.getElementById('pagination');
    paginationContainer.innerHTML = ''; // Clear existing pagination

    const totalPages = Math.ceil(totalRows / rowsPerPage);

    // Previous button
    const prevButton = document.createElement('button');
    prevButton.innerText = 'Previous';
    prevButton.disabled = currentPage === 1;
    prevButton.onclick = () => {
        if (currentPage > 1) {
            currentPage--;
            renderTable(chemicals);
        }
    };
    paginationContainer.appendChild(prevButton);

    // Next button
    const nextButton = document.createElement('button');
    nextButton.innerText = 'Next';
    nextButton.disabled = currentPage === totalPages;
    nextButton.onclick = () => {
        if (currentPage < totalPages) {
            currentPage++;
            renderTable(chemicals);
        }
    };
    paginationContainer.appendChild(nextButton);
}

// Call renderTable initially to load the table with data when the page loads
window.onload = function() {
    renderTable(chemicals);
};

// function renderTable(data) {
//     const tableBody = document.getElementById('chemicalBody');
//     tableBody.innerHTML = ''; // Clear the table body
// // console.log(document.getElementById("tr1"));
//     data.forEach((chemical, index) => {
//         const row = document.createElement('tr');
        // row.innerHTML = `<tr id="tr${chemicals.id}">
        // <td> <i id="${chemical.id}" onclick="selectForDelete(event)"  style="color:#ddd;cursor:pointer;" class="fa-solid fa-check"></i></td>
        //     <td>${chemical.id}</td>
        //     <td>${chemical.Chemicalname}</td>
        //     <td>${chemical.Vender}</td>
        //     <td>${chemical.Density}</td>
        //     <td>${chemical.Viscosity}</td>
        //     <td>${chemical.Packaging}</td>
        //     <td>${chemical.Packsize}</td>
        //     <td>${chemical.Unit}</td>
        //     <td>${chemical.Quantity}</td></tr>
//                     `;
//         tableBody.appendChild(row);
//     });
// }




// onMouseOver="this.style.color='#0F0'"
// onMouseOut="this.style.color='#00F'" 